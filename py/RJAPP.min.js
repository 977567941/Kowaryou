// 本资源来源于互联网公开渠道，仅可用于个人学习爬虫技术。
// 严禁将其用于任何商业用途，下载后请于 24 小时内删除，搜索结果均来自源站，本人不承担任何责任。
let t="";const e=new Set(["泰剧","日剧","美剧","台剧"]),o={"User-Agent":"okhttp-okgo/jeasonlzy",Connection:"Keep-Alive","Accept-Language":"zh-CN,zh;q=0.8"};async function r(e){let o=e.ext;"string"==typeof o&&o.startsWith("http")&&(t=o)}async function n(r){if(!t)return JSON.stringify({class:[]});const n=await req(`${t}/v3/type/top_type`,{method:"post",data:_(),postType:"form",headers:o}),a=JSON.parse(n.content);let s=[];for(const t of a.data.list)e.has(t.type_name)||s.push({type_id:t.type_id.toString(),type_name:t.type_name});return JSON.stringify({class:s})}async function a(){if(!t)return JSON.stringify({list:[]});const r=await req(`${t}/v3/type/tj_vod`,{method:"post",data:_({"":""}),postType:"form",headers:o}),n=JSON.parse(r.content).data;let a=[];a.push(...c(n.cai||[])),a.push(...c(n.loop||[]));for(const t of n.type_vod||[])e.has(t.type_name)||a.push(...c(t.vod||[]));return JSON.stringify({list:a})}async function s(e,r,n,a){if(!t)return JSON.stringify({list:[]});const s=await req(`${t}/v3/home/type_search`,{method:"post",data:_({type_id:e.toString(),page:r.toString()}),postType:"form",headers:o}),i=JSON.parse(s.content);return JSON.stringify({list:c(i.data.list),page:parseInt(r)})}async function i(e,r,n=1){if(!t)return JSON.stringify({list:[]});const a=await req(`${t}/v3/home/search`,{method:"post",data:_({keyword:e}),postType:"form",headers:o});let s=c(JSON.parse(a.content).data.list);return JSON.stringify({list:s,page:parseInt(n||"1")})}async function p(e){if(!t)return JSON.stringify({list:[]});const r=await req(`${t}/v3/home/vod_details`,{method:"post",data:_({vod_id:e.toString()}),postType:"form",headers:o}),n=JSON.parse(r.content).data;let a=[],s=[];for(const t of n.vod_play_list){const e=t.parse_urls.join(",");let o=[];for(const r of t.urls)o.push(`${r.name}$${r.url}@${e}@${t.ua||""}@${t.referer||""}`);s.push(o.join("#"));let r=(t.title||t.name||"").replace(/[\(（](?:点击|换)[^)]*[\)）]|[Z▶❤【].*/g,"");r===t.flag?a.push(r):a.push(`${r}(${t.flag})`)}const i={vod_id:n.vod_id.toString(),vod_name:n.vod_name,vod_pic:n.vod_pic||n.vod_pic_thumb,vod_remarks:n.vod_remarks,vod_year:n.vod_year,vod_area:n.vod_area,vod_actor:n.vod_actor,vod_director:n.vod_director,vod_content:n.vod_content,vod_play_from:a.join("$$$"),vod_play_url:s.join("$$$"),type_name:n.vod_class};return JSON.stringify({list:[i]})}async function d(t,e,r){const n=e.split("@"),a=n[0],s=n[1]?n[1].split(","):[],i=n[2]||"",p=n[3]||"";let d={};i&&(d["User-Agent"]=i),p&&(d.Referer=p);let c="",_=0;for(const t of s)if(t.startsWith("http"))try{const e=await req(t+a,{headers:o}),r=JSON.parse(e.content);if(r.url&&r.url.startsWith("http")){c=r.url;break}}catch(t){}return!c&&a.startsWith("http")&&(c=a,/(?:www\.iqiyi|v\.qq|v\.youku|www\.mgtv|www\.bilibili)\.com/.test(a)&&(_=1)),JSON.stringify({parse:_,url:c,header:d})}function c(t){let e=[];for(const o of t)try{"首页轮播"!==o.vod_name&&e.push({vod_id:o.vod_id.toString(),vod_name:o.vod_name,vod_pic:o.vod_pic||o.vod_pic_thumb,vod_remarks:o.vod_remarks,type_name:o.type_name,vod_year:o.vod_year})}catch(t){}return e}function _(t={}){const e=Math.floor(Date.now()/1e3).toString();return{...t,sign:md5X("7gp0bnd2sr85ydii2j32pcypscoc4w6c7g5spl"+e),timestamp:e}}export function __jsEvalReturn(){return{init:r,home:n,homeVod:a,category:s,search:i,detail:p,play:d}}